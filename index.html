
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <meta
            name="Puppy Gaming"
            content="Documentation for Puppy Gaming modifications"
        >
    <title>PuppyGaming Docs</title>

    <style media="screen">
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s, .highlight .sa, .highlight .dl {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf, .highlight .fm {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv, .highlight .vm {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .nl {
  color: #f92672;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <style media="print">
      * {
        -webkit-transition:none!important;
        transition:none!important;
      }
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #586e75;
}
.highlight .err {
  color: #002b36;
  background-color: #dc322f;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cm, .highlight .cpf, .highlight .c1, .highlight .cs {
  color: #657b83;
}
.highlight .cp {
  color: #b58900;
}
.highlight .nt {
  color: #b58900;
}
.highlight .o, .highlight .ow {
  color: #93a1a1;
}
.highlight .p, .highlight .pi {
  color: #93a1a1;
}
.highlight .gi {
  color: #859900;
}
.highlight .gd {
  color: #dc322f;
}
.highlight .gh {
  color: #268bd2;
  background-color: #002b36;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #6c71c4;
}
.highlight .kc {
  color: #cb4b16;
}
.highlight .kt {
  color: #cb4b16;
}
.highlight .kd {
  color: #cb4b16;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .dl, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #859900;
}
.highlight .sa {
  color: #6c71c4;
}
.highlight .sr {
  color: #2aa198;
}
.highlight .si {
  color: #d33682;
}
.highlight .se {
  color: #d33682;
}
.highlight .nn {
  color: #b58900;
}
.highlight .nc {
  color: #b58900;
}
.highlight .no {
  color: #b58900;
}
.highlight .na {
  color: #268bd2;
}
.highlight .m, .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mx {
  color: #859900;
}
.highlight .ss {
  color: #859900;
}
    </style>
    <link href="stylesheets/screen-84032add.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-953e3353.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-b12a2749.js"></script>

    <script>
      $(function() { setupCodeCopy(); });
    </script>
  </head>

  <body class="index" data-languages="[&quot;csharp&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar-cad8cdcb.png" alt="" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo-cc913a82.png" class="logo" alt="" />
        <div class="lang-selector">
              <a href="#" data-language-name="csharp">csharp</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
          </li>
          <li>
            <a href="#host-can-restart-game" class="toc-h1 toc-link" data-title="Host Can Restart Game">Host Can Restart Game</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#gamemanager-cs" class="toc-h2 toc-link" data-title="GameManager.cs">GameManager.cs</a>
                  </li>
                  <li>
                    <a href="#canvas-in-game-scene" class="toc-h2 toc-link" data-title="Canvas in Game Scene">Canvas in Game Scene</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#cosmetics-with-cbs-inventory" class="toc-h1 toc-link" data-title="Cosmetics with CBS Inventory">Cosmetics with CBS Inventory</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#charactercustomizer-cs" class="toc-h2 toc-link" data-title="CharacterCustomizer.cs">CharacterCustomizer.cs</a>
                  </li>
                  <li>
                    <a href="#cosmeticitemdata-cs" class="toc-h2 toc-link" data-title="CosmeticItemData.cs">CosmeticItemData.cs</a>
                  </li>
                  <li>
                    <a href="#cbs-configurator" class="toc-h2 toc-link" data-title="CBS Configurator">CBS Configurator</a>
                  </li>
                  <li>
                    <a href="#main-menu-scene" class="toc-h2 toc-link" data-title="Main Menu Scene">Main Menu Scene</a>
                  </li>
                  <li>
                    <a href="#how-to-test" class="toc-h2 toc-link" data-title="How to test">How to test</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#line-render-while-aiming-joystick" class="toc-h1 toc-link" data-title="Line Render while aiming joystick">Line Render while aiming joystick</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#playercontroller-cs" class="toc-h2 toc-link" data-title="PlayerController.cs">PlayerController.cs</a>
                  </li>
                  <li>
                    <a href="#player-prefab" class="toc-h2 toc-link" data-title="Player Prefab">Player Prefab</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#shoot-on-joystick-release" class="toc-h1 toc-link" data-title="Shoot on Joystick release">Shoot on Joystick release</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#joystick-cs" class="toc-h2 toc-link" data-title="Joystick.cs">Joystick.cs</a>
                  </li>
                  <li>
                    <a href="#controlsmanager-cs" class="toc-h2 toc-link" data-title="ControlsManager.cs">ControlsManager.cs</a>
                  </li>
                  <li>
                    <a href="#playercontroller-cs-2" class="toc-h2 toc-link" data-title="PlayerController.cs">PlayerController.cs</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#game-search-filter" class="toc-h1 toc-link" data-title="Game Search Filter">Game Search Filter</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#lobbybrowserui-cs" class="toc-h2 toc-link" data-title="LobbyBrowserUI.cs">LobbyBrowserUI.cs</a>
                  </li>
                  <li>
                    <a href="#mainmenu-scene" class="toc-h2 toc-link" data-title="MainMenu scene">MainMenu scene</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#change-server-region" class="toc-h1 toc-link" data-title="Change Server Region">Change Server Region</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#connector-cs" class="toc-h2 toc-link" data-title="Connector.cs">Connector.cs</a>
                  </li>
                  <li>
                    <a href="#main-menu-scene-2" class="toc-h2 toc-link" data-title="Main Menu Scene">Main Menu Scene</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#google-login-with-cbs" class="toc-h1 toc-link" data-title="Google Login with CBS">Google Login with CBS</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#loginform-cs" class="toc-h2 toc-link" data-title="LoginForm.cs">LoginForm.cs</a>
                  </li>
                  <li>
                    <a href="#login-scene" class="toc-h2 toc-link" data-title="Login Scene">Login Scene</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#solana-nft-owned-characters-in-progress-webgl" class="toc-h1 toc-link" data-title="Solana NFT owned Characters (In Progress)(WebGL)">Solana NFT owned Characters (In Progress)(WebGL)</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#webgl-index-html" class="toc-h2 toc-link" data-title="WebGL index.html">WebGL index.html</a>
                  </li>
                  <li>
                    <a href="#cryptoreceiver-cs" class="toc-h2 toc-link" data-title="CryptoReceiver.cs">CryptoReceiver.cs</a>
                  </li>
                  <li>
                    <a href="#characterselector-cs" class="toc-h2 toc-link" data-title="CharacterSelector.cs">CharacterSelector.cs</a>
                  </li>
                  <li>
                    <a href="#characterdata-cs" class="toc-h2 toc-link" data-title="CharacterData.cs">CharacterData.cs</a>
                  </li>
                  <li>
                    <a href="#main-menu-scene-3" class="toc-h2 toc-link" data-title="Main Menu Scene">Main Menu Scene</a>
                  </li>
                  <li>
                    <a href="#webgl-page" class="toc-h2 toc-link" data-title="WebGL page">WebGL page</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#troubleshooting" class="toc-h1 toc-link" data-title="Troubleshooting">Troubleshooting</a>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='https://portfolio.puppygaming.co.uk'>View my portfolio</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p><img src="images/header-cf9f311a.png" alt="Puppy Gaming Header"></p>

<p>Welcome to the modifications documentation for Super Multiplayer Shooter Template. I am hoping to hold all the code snippets and written guide for modifications in my videos and also for some more bespoke modifications I have made. I also go through some of these modifications in my <a href='https://youtube.com/playlist?list=PLic6mrfW6bq6zmv83T0aaXMnogH9oJild'>YouTube playlist</a> if you find it easier go along with a video</p>

<p>Donations are always welcome as I don&#39;t charge for any of these modifications.</p>

<p>PayPal - <em>puppygamingdev@gmail.com</em> , </p>

<p>Solana - <em>DvGPrXra1XgXrUY2skBqrvuAxHRCsgiSBndXhKe6HdhK</em> , </p>

<p>BNB(BSC) - <em>0x3D8ECEB3427AeF8Baf8857b0276C7945ac8dA900</em> , </p>

<p>If you want to donate in another way or not in a monetary way feel free to contact me at puppygamingdev@gmail.com or on Discord <em>Shiffed#2071</em></p>
<h1 id='host-can-restart-game'>Host Can Restart Game</h1>
<p>This is a very simple modification to enable the game&#39;s host to restart the game once it&#39;s finished to avoid going back to the Lobby.</p>
<h2 id='gamemanager-cs'>GameManager.cs</h2>
<blockquote>
<p>Add this reference</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">public</span> <span class="n">GameObject</span> <span class="n">restartButton</span><span class="p">;</span>
</code></pre></div>
<blockquote>
<p>Add this to void Start()</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">if</span> <span class="p">(</span><span class="n">PhotonNetwork</span><span class="p">.</span><span class="n">IsMasterClient</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">restart</span><span class="p">.</span><span class="n">Button</span><span class="p">.</span><span class="nf">SetActive</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<blockquote>
<p>Add this to void Awake()</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="n">PhotonNetwork</span><span class="p">.</span><span class="n">AutomaticallySyncScene</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
</code></pre></div>
<blockquote>
<p>Add these Restart methods</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">public</span> <span class="k">void</span> <span class="nf">RestartButton</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">photonView</span><span class="p">.</span><span class="nf">RPC</span><span class="p">(</span><span class="s">"Restart"</span><span class="p">,</span> <span class="n">RpcTarget</span><span class="p">.</span><span class="n">All</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">[</span><span class="n">PunRPC</span><span class="p">]</span>
<span class="k">void</span> <span class="nf">Restart</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">ExitGames</span><span class="p">.</span><span class="n">Client</span><span class="p">.</span><span class="n">Photon</span><span class="p">.</span><span class="n">Hashtable</span> <span class="n">table</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ExitGames</span><span class="p">.</span><span class="n">Client</span><span class="p">.</span><span class="n">Photon</span><span class="p">.</span><span class="nf">Hashtable</span><span class="p">();</span>
  <span class="n">table</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>
  <span class="n">table</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"kills"</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
  <span class="n">table</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"deaths"</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
  <span class="n">table</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"otherscore"</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
  <span class="n">PhotonNetwork</span><span class="p">.</span><span class="n">LocalPlayer</span><span class="p">.</span><span class="nf">SetCustomProperties</span><span class="p">(</span><span class="n">table</span><span class="p">);</span>
  <span class="n">ui</span><span class="p">.</span><span class="nf">UpdateBoards</span><span class="p">();</span>
  <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"Stats Reset"</span><span class="p">);</span>
  <span class="n">PhotonNetwork</span><span class="p">.</span><span class="nf">LoadLevel</span><span class="p">(</span><span class="s">"Game"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>This is the only script that needs editing for this modification.</p>
<h2 id='canvas-in-game-scene'>Canvas in Game Scene</h2>
<p>In the GameOverPanel gameobject, add a button and set the gameobject as inactive.
Drag the Managers Gameobject into the new button&#39;s OnClick() and set the function to GameManager&gt;RestartButton.</p>
<h1 id='cosmetics-with-cbs-inventory'>Cosmetics with CBS Inventory</h1>
<p>This allows you to link the current SMST Cosmetic items to CBS Items and use CBS for the users cosmetics inventory.</p>
<h2 id='charactercustomizer-cs'>CharacterCustomizer.cs</h2>
<blockquote>
<p>At the top of the script add these</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">CBS</span><span class="p">;</span>
</code></pre></div>
<blockquote>
<p>Add these references</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">public</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">CosmeticItemData</span><span class="p">&gt;</span> <span class="n">items</span><span class="p">;</span>
<span class="k">public</span> <span class="n">CosmeticItemData</span><span class="p">[]</span> <span class="n">allCosmetics</span><span class="p">;</span>
<span class="k">private</span> <span class="n">ICBSInventory</span> <span class="n">InventoryModule</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</code></pre></div>
<blockquote>
<p>Replace <em>SampleInventory.instance.items.Length</em> with</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="n">items</span><span class="p">.</span><span class="n">Count</span>
</code></pre></div>
<blockquote>
<p>Ad also replace <em>SampleInventory.instance.items[i]</em> with</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="n">items</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</code></pre></div>
<blockquote>
<p>At the beginning of void Start(), add these</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="n">InventoryModule</span> <span class="p">=</span> <span class="n">CBSModule</span><span class="p">.</span><span class="n">Get</span><span class="p">&lt;</span><span class="n">CBSInventory</span><span class="p">&gt;();</span>
<span class="n">InventoryModule</span><span class="p">.</span><span class="nf">GetInventory</span><span class="p">(</span><span class="n">OnGetInventory</span><span class="p">);</span>
</code></pre></div>
<blockquote>
<p>At the start of void Open(), add this</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">if</span> <span class="p">(</span><span class="n">curSlots</span><span class="p">.</span><span class="n">Count</span> <span class="p">&lt;</span> <span class="n">items</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">curSlots</span><span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">InventorySlot</span><span class="p">&gt;();</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span><span class="p">&lt;</span> <span class="n">items</span><span class="p">.</span><span class="n">Count</span><span class="p">,</span> <span class="n">i</span><span class="p">++)</span>
  <span class="p">{</span>
    <span class="n">InventorySlot</span> <span class="n">s</span> <span class="p">=</span> <span class="nf">Instantiate</span><span class="p">(</span><span class="n">slotPrefab</span><span class="p">,</span> <span class="n">slotHandler</span><span class="p">);</span>
    <span class="n">s</span><span class="p">.</span><span class="n">cc</span> <span class="p">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="n">curSlots</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="nf">RefreshSlots</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
<blockquote>
<p>Then add this method</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">private</span> <span class="k">void</span> <span class="nf">OnGetInventory</span><span class="p">(</span><span class="n">GetInventoryResult</span> <span class="n">result</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">IsSuccess</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="kt">var</span> <span class="n">allItems</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">AllItems</span><span class="p">;</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="n">CBSInventoryItem</span> <span class="n">item</span> <span class="k">in</span> <span class="n">result</span><span class="p">.</span><span class="n">AllItems</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">foreach</span> <span class="p">(</span><span class="n">CosmeticItemData</span> <span class="n">i</span> <span class="k">in</span> <span class="n">allCosmetics</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="p">.</span><span class="n">cbsItemID</span> <span class="p">==</span> <span class="n">item</span><span class="p">.</span><span class="n">ID</span><span class="p">)</span>
        <span class="p">{</span>
          <span class="k">if</span> <span class="p">(!</span><span class="n">items</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
          <span class="p">{</span>
            <span class="kt">int</span> <span class="n">addLocation</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
            <span class="k">while</span> <span class="p">(</span><span class="n">addLocation</span> <span class="p">&lt;</span> <span class="n">items</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span>
            <span class="p">{</span>
              <span class="n">addLocation</span><span class="p">++;</span>
            <span class="p">}</span>
            <span class="n">items</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"Found item from CBS ID; "</span> <span class="p">+</span> <span class="n">item</span><span class="p">.</span><span class="n">ID</span> <span class="p">+</span> <span class="s">" which mathces item "</span> <span class="p">+</span> <span class="n">i</span><span class="p">.</span><span class="n">name</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>In this script we are chaging where we get the list of SMST Cosmetic Items, creating a new list which will be what the cosmetics window uses to populate and then comparing to Cosmetic Items available against the items the player has in their CBS Inventory and add it to our new list</p>
<h2 id='cosmeticitemdata-cs'>CosmeticItemData.cs</h2>
<blockquote>
<p>Add this variable</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">public</span> <span class="kt">string</span> <span class="n">cbsItemID</span><span class="p">;</span>
</code></pre></div>
<p>Here we are just adding a reference to the cosmetic items counterpart in the CBS Items. This item id will be what we set the CBS Item ID as. So give each of your Cosmetic Items a memorable ID like &quot;hat1&quot;</p>
<h2 id='cbs-configurator'>CBS Configurator</h2><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="c1">// no code on this section</span>
</code></pre></div>
<p>In the Configurator, go to Items and create a new item to match one of your current SMST Cosmetics, and make sure to set the Item ID then same as what you added as the items cbsItemID.</p>
<h2 id='main-menu-scene'>Main Menu Scene</h2><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="c1">// no code in this section</span>
</code></pre></div>
<p>On the <em>Managers</em> GameObject, add all your SMST cosmetics to the CharacterCustomizer component under the <em>All Items</em> list. Also make sure you items are still updated in the <em>ItemLibrary</em> GameObject as per normal when creating new SMST Cosmetics.</p>
<h2 id='how-to-test'>How to test</h2><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="c1">// no code in this section</span>
</code></pre></div>
<p>If you wish to test this out, you can go to your PlayFab Dashboard, find your player and go to Inventory. You can then grant your player an item, run the game and open up your cosmetics page and you should now see the items you own with CBS.</p>
<h1 id='line-render-while-aiming-joystick'>Line Render while aiming joystick</h1>
<p>This will only work while using mobile joysticks and will display a line from the player in the aiming direction</p>
<h2 id='playercontroller-cs'>PlayerController.cs</h2>
<blockquote>
<p>Add these references </p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">public</span> <span class="n">GameObject</span> <span class="n">lineStart</span><span class="p">;</span>
<span class="k">public</span> <span class="n">GameObject</span> <span class="n">lineExit</span><span class="p">;</span>
</code></pre></div>
<blockquote>
<p>In <em>void Update()</em> directly underneath where it says <em>HandleInputs();</em> add this</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">if</span> <span class="p">(</span><span class="n">gm</span><span class="p">.</span><span class="n">controlsManager</span><span class="p">.</span><span class="n">shootStick</span><span class="p">.</span><span class="n">isHolding</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">LineRenderer</span> <span class="n">lineRenderer</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">LineRenderer</span><span class="p">&gt;();</span>
  <span class="n">lineRenderer</span><span class="p">.</span><span class="n">enabled</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
  <span class="n">lineRenderer</span><span class="p">.</span><span class="n">positionCount</span> <span class="p">=</span> <span class="m">2</span><span class="p">;</span>
  <span class="n">lineRenderer</span><span class="p">.</span><span class="nf">SetPosition</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="n">lineStart</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">);</span>
  <span class="n">lineRenderer</span><span class="p">.</span><span class="nf">SetPosition</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="n">lineExit</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">else</span>
<span class="p">{</span>
  <span class="n">LineRenderer</span> <span class="n">lineRenderer</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">LineRenderer</span><span class="p">&gt;();</span>
  <span class="n">lineRenderer</span><span class="p">.</span><span class="n">enabled</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>Here we are stating that when we are holding the shooting joystick down, we are activation the Line Renderer component between the start and exit points that we are going to set.</p>
<h2 id='player-prefab'>Player Prefab</h2><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="c1">// no code in this section</span>
</code></pre></div>
<p>Add a Line Renderer component to your Player prefab and untick it so by default it will be inactive then inside the WeaponHandler Gameobject, add 2 empty gameobjects and call them LineStart &amp; LineExit. Set the transform of LineStart to (0, 0, 0) and the transform of LineExit to (10, 0, 0). To edit the appearance you can tick the component to make it active again and change the component&#39;s Material, then when finished just make sure it&#39;s unticked again.</p>
<h1 id='shoot-on-joystick-release'>Shoot on Joystick release</h1>
<p>With this, it will shoot when you release the shooting joystick. This is handy for Sniper type weapons where you can hold it to aim and then release to shoot.</p>
<h2 id='joystick-cs'>Joystick.cs</h2>
<blockquote>
<p>Add this reference</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">public</span> <span class="kt">bool</span> <span class="n">canShoot</span><span class="p">;</span>
</code></pre></div>
<blockquote>
<p>In <em>OnPointerUp()</em> add</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="n">canShoot</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
</code></pre></div>
<p>This just to say that when we release the touch on the joystick, we are allowed to shoot.</p>
<h2 id='controlsmanager-cs'>ControlsManager.cs</h2>
<blockquote>
<p>Add this reference</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">public</span> <span class="kt">bool</span> <span class="n">canShootNow</span><span class="p">;</span>
</code></pre></div>
<blockquote>
<p>In <em>LateUpdate()</em>, comment out the current part with <em>//</em> and add this below</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="n">shoot</span> <span class="p">=</span> <span class="n">mobileControls</span> <span class="p">?</span> <span class="n">canShootNow</span> <span class="p">:</span> <span class="n">Input</span><span class="p">.</span><span class="nf">GetButton</span><span class="p">(</span><span class="s">"Fire1"</span><span class="p">);</span>
</code></pre></div>
<blockquote>
<p>In <em>Update()</em> add this</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="n">canShootNow</span> <span class="p">=</span> <span class="n">shootStick</span><span class="p">.</span><span class="n">canShoot</span><span class="p">;</span>
</code></pre></div>
<p>We are just modifying the current &#39;shoot&#39; bool which the PlayerController script will use for shooting.</p>
<h2 id='playercontroller-cs-2'>PlayerController.cs</h2>
<blockquote>
<p>In <em>public void Shoot()</em>, add this at the end</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="n">GameManager</span><span class="p">.</span><span class="n">instance</span><span class="p">.</span><span class="n">controlsManager</span><span class="p">.</span><span class="n">shootStick</span><span class="p">.</span><span class="n">canShoot</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
</code></pre></div>
<p>This is setting the canShoot bool back to false after we have taken a shot, otherwise we would continiously shoot after we release the joystick.</p>
<h1 id='game-search-filter'>Game Search Filter</h1>
<p>This is a simple addition to be able to search through the available Lobbys using the hosts name which is also used as the game&#39;s name. For now this is Case Sensitive when searching, I aim to modify this again.</p>
<h2 id='lobbybrowserui-cs'>LobbyBrowserUI.cs</h2>
<blockquote>
<p>Add these references</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">public</span> <span class="n">InputField</span> <span class="n">searchField</span><span class="p">;</span>
</code></pre></div>
<blockquote>
<p>Directly after <em>r.Set(Connector.instance.rooms[i], this);</em> in <em>RefreshBrowser()</em> insert this on the next line</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">if</span> <span class="p">(</span><span class="n">searchField</span><span class="p">.</span><span class="n">text</span> <span class="p">!=</span> <span class="s">""</span> <span class="p">&amp;&amp;</span> <span class="n">r</span><span class="p">.</span><span class="n">nameText</span><span class="p">.</span><span class="n">text</span> <span class="p">!=</span> <span class="n">searchField</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">r</span><span class="p">.</span><span class="n">gameObject</span><span class="p">.</span><span class="nf">SetActive</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>This is the basic function edit that will, if there is any text in the search field, remove any games from the list that do not match the typed name.</p>
<h2 id='mainmenu-scene'>MainMenu scene</h2><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="c1">// No code in this section</span>
</code></pre></div>
<p>In the MainMenu scene under Canvas&gt;LobbyBrowserPanel create a new Button and InputField. For the Button&#39;s OnClick() function drag the <em>Managers</em> GameObject to it and use the <em>LobbyBrowserUI &gt; RefreshBrowser</em> function. Then on the <em>Managers</em> GameObject, under the LobbyBrowserUI component, drag the InputField to the new InputField value we created.</p>
<h1 id='change-server-region'>Change Server Region</h1>
<p>This simple edit will allow the user to change their server region from in-game</p>
<h2 id='connector-cs'>Connector.cs</h2>
<blockquote>
<p>At the top add this</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">UnityEngine.UI</span><span class="p">;</span>
</code></pre></div>
<blockquote>
<p>Add this reference</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">public</span> <span class="n">Dropdown</span> <span class="n">serverList</span><span class="p">;</span>
</code></pre></div>
<blockquote>
<p>Add this function</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">public</span> <span class="k">void</span> <span class="nf">CustomServer</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">var</span> <span class="n">serverChoice</span> <span class="p">=</span> <span class="n">serverList</span><span class="p">.</span><span class="k">value</span><span class="p">;</span>
  <span class="n">ServerList</span> <span class="n">newServer</span> <span class="p">=</span> <span class="p">(</span><span class="n">ServerList</span><span class="p">)</span><span class="n">serverChoice</span><span class="p">;</span>
  <span class="n">PhotonNetwork</span><span class="p">.</span><span class="n">PhotonServerSettings</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">.</span><span class="n">FixedRegion</span> <span class="p">=</span> <span class="n">newServer</span><span class="p">.</span><span class="nf">ToString</span><span class="p">();</span>
  <span class="n">PhotonNetwork</span><span class="p">.</span><span class="nf">Disconnect</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
<blockquote>
<p>At the end of the script after the last <em>}</em> add this enum and replace or reorder them as you like using Photon Server Region Codes (Link in central section of page)</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">public</span> <span class="k">enum</span> <span class="n">ServerList</span>
<span class="p">{</span>
    <span class="n">eu</span> <span class="p">=</span> <span class="m">0</span><span class="p">,</span>
    <span class="n">us</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
    <span class="n">asia</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span>
    <span class="n">ru</span> <span class="p">=</span> <span class="m">3</span><span class="p">,</span>
    <span class="n">za</span> <span class="p">=</span> <span class="m">4</span>
<span class="p">}</span>
</code></pre></div>
<p>All it takes is a simple function that takes the users chosen server region code from the Dropdown choices number, grabs the region code by using the enum we add at the end and then sets that as our chosen server, then uses the already in place Reconnect function to reconnect to Photon using our new choice. https://doc.photonengine.com/zh-cn/pun/current/connection-and-authentication/regions</p>
<h2 id='main-menu-scene-2'>Main Menu Scene</h2><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="c1">// No code in this section</span>
</code></pre></div>
<p>Add a new Dropbdown box where you want and for each server you added to the <em>ServerList</em> enum, add them to the dropdown options, in the exact same order. Then drag the <em>Managers</em> GameObject to the Dropdown&#39;s <em>On Value Changed</em> and use <em>Connector &gt; CustomServer()</em>. Finally, in the Connector component of the <em>Managers</em> GameObject, drag your Dropdown into the new Server List dropdown reference.</p>
<h1 id='google-login-with-cbs'>Google Login with CBS</h1>
<p>You will need to have the GooglePlayGames SDK imported and this still contains a bug (at least for me anyways) where I click the button and it logs me into Google Play but then I have to press again for it to go to the MainMenu Scene.</p>
<h2 id='loginform-cs'>LoginForm.cs</h2>
<blockquote>
<p>Add these to the top of the Script</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">GooglePlayGames</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">GooglePlayGames.BasicApi</span><span class="p">;</span>
</code></pre></div>
<blockquote>
<p>Add this to Start()</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="n">PlayGamesClientConfiguration</span> <span class="n">config</span> <span class="p">=</span> <span class="k">new</span> <span class="n">PlayGamesClientConfiguration</span><span class="p">.</span><span class="nf">Builder</span><span class="p">()</span>
<span class="p">.</span><span class="nf">AddOauthScope</span><span class="p">(</span><span class="s">"profile"</span><span class="p">)</span>
<span class="p">.</span><span class="nf">RequestServerAuthCode</span><span class="p">(</span><span class="k">false</span><span class="p">)</span>
<span class="p">.</span><span class="nf">Build</span><span class="p">();</span>
<span class="n">PlayGamesPlatform</span><span class="p">.</span><span class="nf">InitializeInstance</span><span class="p">(</span><span class="n">config</span><span class="p">);</span>

<span class="c1">// recommended for debugging:</span>
<span class="n">PlayGamesPlatform</span><span class="p">.</span><span class="n">DebugLogEnabled</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>

<span class="c1">// Activate the Google Play Games platform</span>
<span class="n">PlayGamesPlatform</span><span class="p">.</span><span class="nf">Activate</span><span class="p">();</span>
</code></pre></div>
<blockquote>
<p>Add these functions</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">public</span> <span class="k">void</span> <span class="nf">OnLoginWithGoogle</span><span class="p">()</span>
<span class="p">{</span>
  <span class="k">new</span> <span class="nf">PopupViewer</span><span class="p">().</span><span class="nf">ShowLoadingPopup</span><span class="p">();</span>
  <span class="kt">string</span> <span class="n">serverAuthCode</span> <span class="p">=</span> <span class="n">PlayGamesPlatform</span><span class="p">.</span><span class="n">Instance</span><span class="p">.</span><span class="nf">GetServerAuthCode</span><span class="p">();</span>
  <span class="n">Auth</span><span class="p">.</span><span class="nf">LoginWithGoolge</span><span class="p">(</span><span class="n">serverAuthCode</span><span class="p">,</span> <span class="n">OnGoogleUserLogin</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">private</span> <span class="k">void</span> <span class="nf">OnGoogleUserLogin</span><span class="p">(</span><span class="n">CBSLoginResult</span> <span class="n">result</span><span class="p">)</span>
<span class="p">{</span>

  <span class="n">Social</span><span class="p">.</span><span class="n">localUser</span><span class="p">.</span><span class="nf">Authenticate</span><span class="p">((</span><span class="kt">bool</span> <span class="n">success</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>

  <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"Google Signed In"</span><span class="p">);</span>
  <span class="kt">var</span> <span class="n">serverAuthCode</span> <span class="p">=</span> <span class="n">PlayGamesPlatform</span><span class="p">.</span><span class="n">Instance</span><span class="p">.</span><span class="nf">GetServerAuthCode</span><span class="p">();</span>
  <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"Auth Code: "</span> <span class="p">+</span> <span class="n">serverAuthCode</span><span class="p">);</span>
  <span class="k">new</span> <span class="nf">PopupViewer</span><span class="p">().</span><span class="nf">HideLoadingPopup</span><span class="p">();</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">IsSuccess</span><span class="p">)</span>
  <span class="p">{</span>
  <span class="c1">// goto main screen</span>
    <span class="n">gameObject</span><span class="p">.</span><span class="nf">SetActive</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>
    <span class="n">OnLogined</span><span class="p">?.</span><span class="nf">Invoke</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
    <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">"User with ID {0} successfully log in"</span><span class="p">,</span> <span class="n">result</span><span class="p">.</span><span class="n">PlayerId</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="p">});</span>
<span class="p">}</span>
</code></pre></div>
<p>This is essentially the Code to activate the Play Games Platform and how to login.</p>
<h2 id='login-scene'>Login Scene</h2><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="c1">// No code in this section</span>
</code></pre></div>
<p>Add you new button and give the <em>OnClick</em> the new <em>OnLoginWithGoogle</em> function from LoginForm.cs</p>
<h1 id='solana-nft-owned-characters-in-progress-webgl'>Solana NFT owned Characters (In Progress)(WebGL)</h1>
<p>This is a work in progress on integrating the Phantom Wallet login to the WebGL page and passing the mint for each owned NFT to a script in Unity which will add all mint IDs to a list to be used for comparison against a mintID value each character will have. We will then only allow the characters with a matching mint ID to be usable. This could also be edited with the Cosmetic modification to use NFTs instead of CBS Items.</p>
<h2 id='webgl-index-html'>WebGL index.html</h2>
<blockquote>
<p>Where you would like them, add some buttons for connecting wallet and loggin out of wallet using our functions</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code>      <span class="p">&lt;</span><span class="n">button</span> <span class="n">onclick</span><span class="p">=</span><span class="s">"getAccount()"</span><span class="p">&gt;</span><span class="n">Get</span> <span class="n">Account</span><span class="p">&lt;/</span><span class="n">button</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="n">button</span> <span class="n">onclick</span><span class="p">=</span><span class="s">"logoutAccount()"</span><span class="p">&gt;</span><span class="n">Logout</span><span class="p">&lt;/</span><span class="n">button</span><span class="p">&gt;</span>
</code></pre></div>
<blockquote>
<p>At the start of the <em>Script</em> region add this var</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="kt">var</span> <span class="n">webglPlayer</span><span class="p">;</span>
</code></pre></div>
<blockquote>
<p>Search for <em>.then((unityInstance) =&gt; {</em> and on the next line add this</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="n">webglPlayer</span> <span class="p">=</span> <span class="n">unityInstance</span><span class="p">;</span>
</code></pre></div>
<blockquote>
<p>Add this after the Unity parts in the <em>Script</em> area, add this</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code>      <span class="c1">// Custom functions</span>
      <span class="kt">var</span> <span class="n">wallet</span><span class="p">;</span>
      <span class="kt">var</span> <span class="n">myKey</span><span class="p">;</span>
      <span class="kt">var</span> <span class="n">tokenResponse</span><span class="p">;</span>
      <span class="kt">var</span> <span class="n">myTokens</span> <span class="p">=</span> <span class="p">[];</span>
      <span class="k">async</span> <span class="n">function</span> <span class="nf">getAccount</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">window</span><span class="p">.</span><span class="n">solana</span><span class="p">.</span><span class="nf">connect</span><span class="p">();</span>
        <span class="n">wallet</span> <span class="p">=</span> <span class="k">await</span> <span class="n">window</span><span class="p">.</span><span class="n">solana</span><span class="p">.</span><span class="nf">request</span><span class="p">({</span> <span class="n">method</span><span class="p">:</span> <span class="s">"connect"</span> <span class="p">});</span>
        <span class="c1">// console.log(wallet);</span>
        <span class="n">myKey</span> <span class="p">=</span> <span class="n">wallet</span><span class="p">.</span><span class="n">publicKey</span><span class="p">.</span><span class="nf">toString</span><span class="p">();</span>

        <span class="nf">allTokens</span><span class="p">();</span>
      <span class="p">}</span>

      <span class="n">function</span> <span class="nf">logoutAccount</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">window</span><span class="p">.</span><span class="n">solana</span><span class="p">.</span><span class="nf">request</span><span class="p">({</span> <span class="n">method</span><span class="p">:</span> <span class="s">"disconnect"</span> <span class="p">});</span>
      <span class="p">}</span>

      <span class="n">function</span> <span class="nf">allTokens</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="s">"Your Public Key is "</span><span class="p">,</span> <span class="n">myKey</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">url</span> <span class="p">=</span> <span class="s">"https://api.mainnet-beta.solana.com"</span><span class="p">;</span>

        <span class="kt">var</span> <span class="n">xhr</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">XMLHttpRequest</span><span class="p">();</span>
        <span class="n">xhr</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="s">"POST"</span><span class="p">,</span> <span class="n">url</span><span class="p">);</span>
        <span class="n">xhr</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="s">"Content-Type"</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

        <span class="n">xhr</span><span class="p">.</span><span class="n">onreadystatechange</span> <span class="p">=</span> <span class="nf">function</span> <span class="p">()</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">xhr</span><span class="p">.</span><span class="n">readyState</span> <span class="p">===</span> <span class="m">4</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// console.log(xhr.status);</span>
            <span class="k">const</span> <span class="n">tokenResponse</span> <span class="p">=</span> <span class="n">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">xhr</span><span class="p">.</span><span class="n">responseText</span><span class="p">);</span>
            <span class="c1">// console.log(tokenResponse.result.value);</span>
            <span class="n">myTokens</span> <span class="p">=</span> <span class="n">tokenResponse</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="k">value</span><span class="p">;</span>
            <span class="nf">sendTokenList</span><span class="p">();</span>
          <span class="p">}</span>
        <span class="p">};</span>
        <span class="kt">var</span> <span class="n">data</span> <span class="p">=</span> <span class="err">`</span>
              <span class="p">{</span>
                <span class="s">"jsonrpc"</span><span class="p">:</span> <span class="s">"2.0"</span><span class="p">,</span>
                <span class="s">"id"</span><span class="p">:</span> <span class="m">1</span><span class="p">,</span>
                <span class="s">"method"</span><span class="p">:</span> <span class="s">"getTokenAccountsByOwner"</span><span class="p">,</span>
                <span class="s">"params"</span><span class="p">:</span> <span class="p">[</span>
                  <span class="s">"${myKey}"</span><span class="p">,</span>
                  <span class="p">{</span>
                    <span class="s">"programId"</span><span class="p">:</span> <span class="s">"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"</span>
                  <span class="p">},</span>
                  <span class="p">{</span>
                    <span class="s">"encoding"</span><span class="p">:</span> <span class="s">"jsonParsed"</span>
                  <span class="p">}</span>
                <span class="p">]</span>
              <span class="p">}</span>
            <span class="err">`</span><span class="p">;</span>

        <span class="n">xhr</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="n">function</span> <span class="nf">sendTokenList</span><span class="p">()</span> <span class="p">{</span>
        <span class="kt">var</span> <span class="n">tokenLength</span> <span class="p">=</span> <span class="n">myTokens</span><span class="p">.</span><span class="n">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">var</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">tokenLength</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span>
            <span class="n">myTokens</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">account</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">parsed</span><span class="p">.</span><span class="n">info</span><span class="p">.</span><span class="n">tokenAmount</span><span class="p">.</span><span class="n">decimals</span> <span class="p">==</span> <span class="m">0</span> <span class="p">&amp;&amp;</span>
            <span class="n">myTokens</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">account</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">parsed</span><span class="p">.</span><span class="n">info</span><span class="p">.</span><span class="n">tokenAmount</span><span class="p">.</span><span class="n">amount</span> <span class="p">&gt;</span> <span class="s">"0"</span>
          <span class="p">)</span> <span class="p">{</span>
            <span class="n">webglPlayer</span><span class="p">.</span><span class="nf">SendMessage</span><span class="p">(</span>
              <span class="s">"CryptoReceiver"</span><span class="p">,</span>
              <span class="s">"ReceiveToken"</span><span class="p">,</span>
              <span class="n">myTokens</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">account</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">parsed</span><span class="p">.</span><span class="n">info</span><span class="p">.</span><span class="n">mint</span>
            <span class="p">);</span>
            <span class="n">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="n">myTokens</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">account</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">parsed</span><span class="p">.</span><span class="n">info</span><span class="p">.</span><span class="n">mint</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
</code></pre></div>
<p>This will add the necessary buttons and functions to the webpage displaying the WebGL build to pass information to the build.</p>
<h2 id='cryptoreceiver-cs'>CryptoReceiver.cs</h2>
<blockquote>
<p>Replace the contents of the default script with this</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System.Collections</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">CryptoReceiver</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">static</span> <span class="n">CryptoReceiver</span> <span class="n">CR</span><span class="p">;</span>
    <span class="k">public</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">myTokens</span><span class="p">;</span>

    <span class="k">void</span> <span class="nf">Awake</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">CR</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">GameObject</span><span class="p">.</span><span class="nf">Destroy</span><span class="p">(</span><span class="n">CR</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">CR</span> <span class="p">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nf">DontDestroyOnLoad</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">ReceiveToken</span><span class="p">(</span><span class="kt">string</span> <span class="n">mint</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(!</span><span class="n">myTokens</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="n">mint</span><span class="p">))</span>
        <span class="p">{</span>
            <span class="kt">int</span> <span class="n">addLocation</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
            <span class="k">while</span> <span class="p">(</span><span class="n">addLocation</span> <span class="p">&lt;</span> <span class="n">myTokens</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">addLocation</span><span class="p">++;</span>
            <span class="p">}</span>
            <span class="n">myTokens</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">mint</span><span class="p">);</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"Added NFT with Mint ID:  "</span> <span class="p">+</span> <span class="n">mint</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>This script receives the data from the web page javascript functions, passing each mint ID as a string and adding it to an accessable list which can be obtained in any script with <em>CryptoReceiver.CR.myTokens</em> , more data will be added in the future e.g icon, metadata.</p>
<h2 id='characterselector-cs'>CharacterSelector.cs</h2>
<blockquote>
<p>Add these references</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code>        <span class="k">public</span> <span class="n">CharacterData</span><span class="p">[]</span> <span class="n">defaultCharacters</span><span class="p">;</span>
        <span class="k">public</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">CharacterData</span><span class="p">&gt;</span> <span class="n">ownedCharacters</span><span class="p">;</span>
</code></pre></div>
<blockquote>
<p>On the first line of <em>void Refresh()</em> add this</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="nf">GetOwnedCharacters</span><span class="p">();</span>
</code></pre></div>
<blockquote>
<p>In <em>void Refresh()</em> look for <em>// Repopulate items</em> and replace that part with this</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="c1">// Repopulate items:</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">defaultCharacters</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
<span class="p">{</span>
  <span class="n">CharacterSelectorItem</span> <span class="n">item</span> <span class="p">=</span> <span class="nf">Instantiate</span><span class="p">(</span><span class="n">itemPrefab</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
  <span class="n">item</span><span class="p">.</span><span class="n">data</span> <span class="p">=</span> <span class="n">defaultCharacters</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
  <span class="n">item</span><span class="p">.</span><span class="n">cs</span> <span class="p">=</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">ownedCharacters</span><span class="p">.</span><span class="n">Count</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
<span class="p">{</span>
  <span class="n">CharacterSelectorItem</span> <span class="n">item</span> <span class="p">=</span> <span class="nf">Instantiate</span><span class="p">(</span><span class="n">itemPrefab</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
  <span class="n">item</span><span class="p">.</span><span class="n">data</span> <span class="p">=</span> <span class="n">ownedCharacters</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
  <span class="n">item</span><span class="p">.</span><span class="n">cs</span> <span class="p">=</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<blockquote>
<p>Add this function somewhere else in the script</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">public</span> <span class="k">void</span> <span class="nf">GetOwnedCharacters</span><span class="p">()</span>
<span class="p">{</span>
  <span class="k">foreach</span> <span class="p">(</span><span class="n">CharacterData</span> <span class="n">c</span> <span class="k">in</span> <span class="n">characters</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="kt">string</span> <span class="n">mint</span> <span class="k">in</span> <span class="n">CryptoReceiver</span><span class="p">.</span><span class="n">CR</span><span class="p">.</span><span class="n">myTokens</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">mint</span> <span class="p">==</span> <span class="n">c</span><span class="p">.</span><span class="n">mintID</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="k">if</span> <span class="p">(!</span><span class="n">ownedCharacters</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
        <span class="p">{</span>
          <span class="kt">int</span> <span class="n">addLocation</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
          <span class="k">while</span> <span class="p">(</span><span class="n">addLocation</span> <span class="p">&lt;</span> <span class="n">ownedCharacters</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span>
          <span class="p">{</span>
            <span class="n">addLocation</span><span class="p">++;</span>
          <span class="p">}</span>
          <span class="n">ownedCharacters</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
          <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"Added Character "</span> <span class="p">+</span> <span class="n">c</span><span class="p">.</span><span class="n">name</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>This script should compare all characters from one list with the mint received from the web page which is stored in our CryptoReceiver and add it to a new list which we will use for selectable characters.</p>
<h2 id='characterdata-cs'>CharacterData.cs</h2>
<blockquote>
<p>Add this variable</p>
</blockquote>
<div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">public</span> <span class="kt">string</span> <span class="n">mintID</span><span class="p">;</span>
</code></pre></div>
<p>This is the variable for each character that is the mint ID of the NFT it represents</p>
<h2 id='main-menu-scene-3'>Main Menu Scene</h2><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="c1">// no code in this section</span>
</code></pre></div>
<p>Create a new GameObject called <em>CryptoReceiver</em> and add the <em>CryptoReceiver</em> script to it. In the <em>Managers</em> GameObject you can go to the <em>Character Selector</em> component and set which characters you would like the player to be able to use by default in the <em>Default Characters</em> array, these will always be loaded. Then for any characters you want to be linked to a token, open the CharacterData ScriptableObject for that character and add its mint ID to new variable string we added on it.</p>
<h2 id='webgl-page'>WebGL page</h2><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="c1">// no code in this section</span>
</code></pre></div>
<p>Once you&#39;ve done everything and uploaded your latest WebGL build, wait until the Main Menu scene has loaded and then click on the <em>Get Account</em> button, you will get a popup to load your Phantom Wallet, just approve and it&#39;ll pass your owned NFTs to the WebGL build. If you click it before the scene has loaded, it can always be clicked again once loaded if your linked characters don&#39;t appear.</p>
<h1 id='troubleshooting'>Troubleshooting</h1>
<aside class="notice">
If you have any issues please feel free to contact me in the support Discords for the covered assets or emailing puppygamingdev@gmail.com
</aside>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="csharp">csharp</a>
          </div>
      </div>
    </div>
  </body>
</html>
